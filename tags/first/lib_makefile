CFLAGS        = -O -g -Wno-deprecated -I../gnu -I. -DOOPARLIB

CC	      = g++

DEST	      = .

EXTHDRS	      = ../gnu/gnudefs.h \
		../gnu/savlist.h

HDRS	      = MetisWrapper.h \
		TDataVersion.h \
		TObjectId.h \
		cmdefs.h \
		communic.h \
		datmanag.h \
		error.h \
		pardefs.h \
		saveable.h \
		storage.h \
		taskman.h \
		tdata.h \
		ttask.h

LIBRARY	      = liboopar.a

MAKEFILE      = makefile

OBJS	      = TDataVersion.o \
		TObjectId.o \
		datmanag.o \
		error.o \
		parclass.o \
		saveable.o \
		storage.o \
		taskman.o \
		tdata.o \
		tstor.o \
		ttask.o

PRINT	      = pr

SRCS	      = TDataVersion.c \
		TObjectId.c \
		datmanag.c \
		error.c \
		parclass.c \
		saveable.c \
		storage.c \
		taskman.c \
		tdata.c \
		tstor.c \
		ttask.c

all:		$(LIBRARY)

dos2unix:;
		dos2unix *.h
		dos2unix *.c

$(LIBRARY):	$(OBJS)
		ar cru $(LIBRARY) $(OBJS)
		ranlib $(LIBRARY)

clean:;		rm -f $(OBJS)

depend:;	mkmf -f $(MAKEFILE) LIBRARY=$(LIBRARY) DEST=$(DEST)

extract:;	ar xo $(DEST)/$(LIBRARY)
		@rm -f __.SYMDEF

index:;		ctags -wx $(HDRS) $(SRCS)

install:	$(LIBRARY)
		install $(LIBRARY) $(DEST)
		ranlib $(DEST)/$(LIBRARY)

library:        $(LIBRARY)

print:;		$(PRINT) $(HDRS) $(SRCS)

tags:           $(HDRS) $(SRCS); ctags $(HDRS) $(SRCS)

update:         $(DEST)/$(LIBRARY)

###
TDataVersion.o: TDataVersion.h storage.h error.h
TObjectId.o: TObjectId.h storage.h error.h
datmanag.o: datmanag.h ../gnu/savlist.h pardefs.h ttask.h saveable.h \
	TDataVersion.h storage.h error.h cmdefs.h TObjectId.h tdata.h \
	taskman.h communic.h ../gnu/gnudefs.h
error.o: error.h
parclass.o: ttask.h saveable.h TDataVersion.h storage.h error.h cmdefs.h \
	pardefs.h TObjectId.h taskman.h datmanag.h ../gnu/savlist.h tdata.h
saveable.o: saveable.h TDataVersion.h storage.h error.h cmdefs.h
storage.o: storage.h error.h cmdefs.h
taskman.o: taskman.h ttask.h saveable.h TDataVersion.h storage.h error.h \
	cmdefs.h pardefs.h TObjectId.h communic.h
tdata.o: tdata.h TDataVersion.h storage.h error.h saveable.h cmdefs.h \
	datmanag.h ../gnu/savlist.h pardefs.h ttask.h TObjectId.h communic.h \
	taskman.h
tstor.o: saveable.h TDataVersion.h storage.h error.h cmdefs.h
ttask.o: ttask.h saveable.h TDataVersion.h storage.h error.h cmdefs.h \
	pardefs.h TObjectId.h taskman.h datmanag.h ../gnu/savlist.h tdata.h \
	communic.h ../gnu/gnudefs.h
